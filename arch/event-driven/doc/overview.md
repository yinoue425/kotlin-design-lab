# イベント駆動アーキテクチャ: ブローカー vs メディエータ

## 概要

イベント駆動アーキテクチャの代表的な2つのトポロジを、同じ「注文処理」ユースケースで実装し比較する。

- **ブローカートポロジ** — 中央のイベントバスがメッセージを転送するだけ。ビジネスロジックは各購読者に分散
- **メディエータトポロジ** — 中央のメディエータがワークフローを制御。処理順序・分岐をメディエータが決定

## パターン比較

| 観点 | ブローカー | メディエータ |
|---|---|---|
| 中央コンポーネントの役割 | ルーティングのみ（ダム） | ワークフロー制御（スマート） |
| コンポーネント間の結合度 | ゼロ | メディエータ経由で間接結合 |
| 処理順序 | 不定（並列可） | メディエータが明示的に制御 |
| エラー時の挙動 | 各購読者が独立処理 | メディエータが後続処理を短絡 |
| 新しいリアクション追加 | 購読者を追加するだけ | メディエータのロジック変更が必要 |
| 適するケース | 通知、ログ、分析など独立処理 | 順序のある業務フロー、サガパターン |
| 実世界の例 | Kafka Consumer Group | BPMN エンジン、サガオーケストレータ |

## 実行方法

```bash
cd arch/event-driven

# ビルド & テスト
./gradlew build

# ブローカーパターンのデモ
./gradlew :broker:run

# メディエータパターンのデモ
./gradlew :mediator:run
```

## 技術スタック

| カテゴリ | 選定 |
|---|---|
| 言語 | Kotlin 2.2.0 |
| ビルド | Gradle 8.14.2 (Kotlin DSL) |
| JVM | Java 21 |
| テスト | kotlin.test + JUnit 5 |
| 外部ライブラリ | なし（標準ライブラリのみ） |
